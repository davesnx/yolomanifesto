language: node_js
node_js:
  - 8

cache:
  directories:
    - "node_modules"

before_script:
  - yarn run lint
  - yarn run build

script:
  - yarn test

after_script:
  - yarn add now
  - if [ "$TRAVIS_BRANCH" == "pull_request" ]; then now --token ${TOKEN_NOW} --public alias; fi

deploy:
  provider: script
  script: now --token ${TOKEN_NOW} --public
  on:
    branch: master
  condition: $TRAVIS_EVENT_TYPE = "push"
  skip_cleanup: true
